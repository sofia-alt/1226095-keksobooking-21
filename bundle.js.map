{"version":3,"sources":["webpack://keksobooking/./js/utils.js","webpack://keksobooking/./js/backend.js","webpack://keksobooking/./js/filter.js","webpack://keksobooking/./js/pin.js","webpack://keksobooking/./js/form.js","webpack://keksobooking/./js/photos.js","webpack://keksobooking/./js/map.js","webpack://keksobooking/./js/move.js","webpack://keksobooking/./js/card.js","webpack://keksobooking/./js/main.js"],"names":[],"mappings":";;;;;;;;AAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;AACA;;;;;;;;;;AC5Ba;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;AC5Ea;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;;;;;;;AC3Ea;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS,WAAW,MAAM;AAC1B;AACA;;AAEA,0BAA0B,kCAAkC;AAC5D,yBAAyB,mBAAmB;;AAE5C;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACjDa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wDAAwD,yBAAyB;AACjF,KAAK;AACL;AACA;AACA;AACA,wDAAwD,qBAAqB;AAC7E,KAAK;AACL;AACA;AACA;AACA,wDAAwD,sBAAsB;AAC9E,KAAK;AACL;AACA;AACA;AACA,wDAAwD,uBAAuB;AAC/E;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,SAAS,0BAA0B;AACnC;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED,qBAAqB,eAAe;AACpC,qBAAqB,OAAO,IAAI,OAAO;AACvC;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACrRa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;;;;;;;;;;AC5Da;;AAEb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,6BAA6B,oBAAoB,oBAAoB,uBAAuB,iBAAiB,qBAAqB,aAAa,kBAAkB,eAAe,yBAAyB;AACzM;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACvGa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,SAAS,sBAAsB;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;ACxHa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iEAAiE,QAAQ;AACzE;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,0BAA0B,MAAM;AAChC;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,SAAS,QAAQ,6FAA6F,WAAW,QAAQ;;AAEjI;;AAEA;AACA;AACA,qEAAqE,MAAM;;AAE3E;AACA,wEAAwE,MAAM,eAAe,OAAO;AACpG,gFAAgF,QAAQ,aAAa,SAAS;;AAE9G;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;ACvGa;;AAEb;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["\"use strict\";\n\nconst DEBOUNCE_INTERVAL = 500;\n\nconst changeDisabledElemetsForm = (elements) => {\n  const isPageActive = window.map.getIsPageActive();\n  Array.from(elements).forEach((element) => {\n    element.disabled = !isPageActive;\n  });\n};\n\nconst debounce = (cb) => {\n  let lastTimeout = null;\n\n  return (...parameters) => {\n    if (lastTimeout) {\n      window.clearTimeout(lastTimeout);\n    }\n    lastTimeout = window.setTimeout(() => {\n      cb(...parameters);\n    }, DEBOUNCE_INTERVAL);\n  };\n};\n\n\nwindow.utils = {\n  changeDisabledElemetsForm,\n  debounce\n};\n","\"use strict\";\n\nconst URL_LOAD = `https://21.javascript.pages.academy/keksobooking/data`;\nconst URL_UPLOAD = `https://21.javascript.pages.academy/keksobooking`;\n\nconst TIMEOUT_IN_MS = 10000;\n\nconst StatusCode = {\n  OK: 200,\n  BAD_REQUEST: 400,\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404\n};\n\nconst HttpRequest = {\n  GET: `GET`,\n  POST: `POST`\n};\n\nconst getInstance = (onSuccess, onError) => {\n  let xhr = new XMLHttpRequest();\n  xhr.responseType = `json`;\n\n  xhr.addEventListener(`load`, () => {\n    let error;\n    switch (xhr.status) {\n      case StatusCode.OK:\n        onSuccess(xhr.response);\n        break;\n      case StatusCode.BAD_REQUEST:\n        error = `Неверный запрос`;\n        break;\n      case StatusCode.UNAUTHORIZED:\n        error = `Пользователь не авторизован`;\n        break;\n      case StatusCode.NOT_FOUND:\n        error = `Ничего не найдено`;\n        break;\n\n      default:\n        error = `Cтатус ответа: : ` + xhr.status + ` ` + xhr.statusText;\n    }\n\n    if (error) {\n      onError(error);\n    }\n  });\n  xhr.addEventListener(`error`, () => {\n    onError(`Произошла ошибка соединения`);\n  });\n  xhr.addEventListener(`timeout`, () => {\n    onError(`Запрос не успел выполниться за ` + xhr.timeout + `мс`);\n  });\n\n  xhr.timeout = TIMEOUT_IN_MS;\n\n  return xhr;\n};\n\nconst load = (onSuccess, onError) => {\n  const xhr = getInstance(onSuccess, onError);\n\n  xhr.open(HttpRequest.GET, URL_LOAD);\n  xhr.send();\n};\n\nconst upload = (data, onSuccess, onError) => {\n  const xhr = getInstance(onSuccess, onError);\n\n  xhr.open(HttpRequest.POST, URL_UPLOAD);\n  xhr.send(data);\n};\n\nwindow.backend = {\n  load,\n  upload\n};\n","\"use strict\";\n\nconst ANY_VALUE = `any`;\nconst COUNT_PIN = 5;\n\nconst housingTypeElement = document.querySelector(`.map__filters #housing-type`);\nconst housingPriceElement = document.querySelector(`.map__filters #housing-price`);\nconst housingRoomsElement = document.querySelector(`.map__filters #housing-rooms`);\nconst housingGuestsElement = document.querySelector(`.map__filters #housing-guests`);\n\nconst PriceValue = {\n  MIDDLE_MIN: 10000,\n  MIDDLE_MAX: 50000,\n  LOW: 10000,\n  HIGH: 50000\n};\n\nconst PriceName = {\n  MIDDLE: `middle`,\n  LOW: `low`,\n  HIGH: `high`\n};\n\nconst getHousingFeatures = () => {\n  return Array.from(document.querySelectorAll(`.map__filters #housing-features input:checked`));\n};\n\nconst isAvaliableHouseType = (pin, housingType) => {\n  return housingType === ANY_VALUE || pin.offer.type === housingType;\n};\n\nconst isAvaliablePrice = (pin, housingPrice) => {\n  switch (housingPrice) {\n    case PriceName.MIDDLE: return pin.offer.price >= PriceValue.MIDDLE_MIN && pin.offer.price <= PriceValue.MIDDLE_MAX;\n    case PriceName.LOW: return pin.offer.price < PriceValue.LOW;\n    case PriceName.HIGH: return pin.offer.price > PriceValue.HIGH;\n    default: return housingPrice === ANY_VALUE;\n  }\n};\n\nconst isAvaliableRooms = (pin, housingRooms) => {\n  return housingRooms === ANY_VALUE || pin.offer.rooms === parseInt(housingRooms, 10);\n};\n\nconst isAvaliableGuests = (pin, housingGuests) => {\n  return housingGuests === ANY_VALUE || pin.offer.guests === parseInt(housingGuests, 10);\n};\n\nconst isAvaliableFeatures = (pin, housingFeatures) => {\n  return housingFeatures.every((feature) => pin.offer.features.includes(feature.value));\n};\n\nconst getResult = (pins) => {\n  const result = [];\n\n  for (let i = 0; i < pins.length; i++) {\n    const pin = pins[i];\n\n    const isFiltred = isAvaliableHouseType(pin, housingTypeElement.value) && isAvaliablePrice(pin, housingPriceElement.value) && isAvaliableRooms(pin, housingRoomsElement.value) && isAvaliableGuests(pin, housingGuestsElement.value)\n      && isAvaliableFeatures(pin, getHousingFeatures());\n\n    if (isFiltred) {\n      result.push(pin);\n\n      if (result.length === COUNT_PIN) {\n        break;\n      }\n    }\n  }\n\n  return result;\n};\n\nwindow.filter = {\n  getResult\n};\n","\"use strict\";\n\nconst SizePin = {\n  WIDTH: 50,\n  HEIGHT: 70\n};\n\nconst pinTemplate = document.querySelector(`#pin`).content.querySelector(`.map__pin`);\n\nlet elementActive = null;\n\nconst addPinEvent = (element, pin) => {\n  element.addEventListener(`click`, () => {\n    window.card.renderPopup(pin);\n    addActiveClass(element);\n  });\n};\n\nconst resetActiveElement = () => {\n  if (elementActive !== null) {\n    elementActive.classList.remove(`map__pin--active`);\n    elementActive = null;\n  }\n};\n\nconst addActiveClass = (element) => {\n  if (elementActive === null) {\n    elementActive = element;\n    elementActive.classList.add(`map__pin--active`);\n  }\n};\n\nconst getElement = (pin) => {\n  const {location: {x, y}} = pin;\n  const element = pinTemplate.cloneNode(true);\n  element.querySelector(`img`).src = pin.author.avatar;\n\n  element.style.left = `${x - Math.floor(SizePin.WIDTH / 2)}px`;\n  element.style.top = `${y - SizePin.HEIGHT}px`;\n\n  addPinEvent(element, pin);\n\n  return element;\n};\n\nwindow.pin = {\n  getElement,\n  resetActiveElement,\n  pinTemplate\n};\n\n","\"use strict\";\n\nconst formInfo = document.querySelector(`.ad-form`);\nconst fieldsetFormInfo = formInfo.getElementsByTagName(`fieldset`);\nconst roomNumber = formInfo.querySelector(`#room_number`);\nconst capacity = formInfo.querySelector(`#capacity`);\n\nconst titleInput = formInfo.querySelector(`#title`);\nconst timeinFormInfo = formInfo.querySelector(`#timein`);\nconst timeoutFormInfo = formInfo.querySelector(`#timeout`);\n\nconst typeHousing = formInfo.querySelector(`#type`);\nconst priceHousing = formInfo.querySelector(`#price`);\n\nconst address = formInfo.querySelector(`#address`);\n\nconst resetForm = formInfo.querySelector(`.ad-form__reset`);\n\nconst errorPopup = document.querySelector(`#error`).content.querySelector(`.error`);\nconst successPopup = document.querySelector(`#success`).content.querySelector(`.success`);\n\nconst ESC_KEY = 27;\n\nconst RoomValue = {\n  ONE: 1,\n  TWO: 2,\n  THREE: 3,\n  HUNDER: 100\n};\n\nconst CapacityValue = {\n  ONE: 1,\n  TWO: 2,\n  THREE: 3,\n  NOTGUEST: 0\n};\n\nconst TitleLength = {\n  MIN_LENGTH: 30,\n  MAX_LENGTH: 100\n};\n\nconst MinPriceHousing = {\n  FLAT: 1000,\n  BUNGALOW: 0,\n  HOUSE: 5000,\n  PALACE: 10000\n};\n\nlet housingValidationInfo;\nlet popupMessage = null;\n\nconst initHousingValidationInfo = () => {\n  housingValidationInfo = {\n    [window.card.OfferType.BUNGALOW]: {\n      min: MinPriceHousing.BUNGALOW,\n      placeholder: MinPriceHousing.BUNGALOW,\n      message: `Значение должно быть больше или равно ${MinPriceHousing.BUNGALOW}`\n    },\n    [window.card.OfferType.FLAT]: {\n      min: MinPriceHousing.FLAT,\n      placeholder: MinPriceHousing.FLAT,\n      message: `Значение должно быть больше или равно ${MinPriceHousing.FLAT}`\n    },\n    [window.card.OfferType.HOUSE]: {\n      min: MinPriceHousing.HOUSE,\n      placeholder: MinPriceHousing.HOUSE,\n      message: `Значение должно быть больше или равно ${MinPriceHousing.HOUSE}`\n    },\n    [window.card.OfferType.PALACE]: {\n      min: MinPriceHousing.PALACE,\n      placeholder: MinPriceHousing.PALACE,\n      message: `Значение должно быть больше или равно ${MinPriceHousing.PALACE}`\n    }\n  };\n};\n\nconst validateRooms = () => {\n  const roomValue = parseInt(roomNumber.value, 10);\n  const capacityValue = parseInt(capacity.value, 10);\n\n  let message = ``;\n  if (roomValue === RoomValue.ONE && capacityValue !== CapacityValue.ONE) {\n    message = `Неверное количество комнат`;\n  } else if (roomValue === RoomValue.TWO && !(capacityValue === CapacityValue.ONE || capacityValue === CapacityValue.TWO)) {\n    message = `Неверное количество комнат`;\n  } else if (roomValue === RoomValue.THREE && capacityValue === CapacityValue.NOTGUEST) {\n    message = `Неверное количество комнат`;\n  } else if (roomValue === RoomValue.HUNDER && capacityValue !== CapacityValue.NOTGUEST) {\n    message = `Неверное количество комнат`;\n  }\n\n  roomNumber.setCustomValidity(message);\n  capacity.setCustomValidity(``);\n};\n\nconst validateCapacity = () => {\n  const roomValue = parseInt(roomNumber.value, 10);\n  const capacityValue = parseInt(capacity.value, 10);\n\n  let message = ``;\n  if (capacityValue === CapacityValue.ONE && roomValue === RoomValue.HUNDER) {\n    message = `Неверное количество гостей`;\n  } else if (capacityValue === CapacityValue.TWO && !(roomValue === RoomValue.TWO || roomValue === RoomValue.THREE)) {\n    message = `Неверное количество гостей`;\n  } else if (capacityValue === CapacityValue.THREE && roomValue !== RoomValue.THREE) {\n    message = `Неверное количество гостей`;\n  } else if (capacityValue === CapacityValue.NOTGUEST && roomValue !== RoomValue.HUNDER) {\n    message = `Неверное количество гостей`;\n  }\n  capacity.setCustomValidity(message);\n  roomNumber.setCustomValidity(``);\n};\n\nconst addEventTitle = () => {\n  titleInput.addEventListener(`input`, () => {\n    let valueLength = titleInput.value.length;\n\n    if (valueLength < TitleLength.MIN_LENGTH) {\n      titleInput.setCustomValidity(`Ещё ` + (TitleLength.MIN_LENGTH - valueLength) + ` симв.`);\n    } else if (valueLength > TitleLength.MAX_LENGTH) {\n      titleInput.setCustomValidity(`Удалите лишние ` + (valueLength - TitleLength.MAX_LENGTH) + ` симв.`);\n    } else {\n      titleInput.setCustomValidity(``);\n    }\n\n    titleInput.reportValidity();\n  });\n};\n\nconst validateTimein = () => {\n  timeoutFormInfo.value = timeinFormInfo.value;\n};\n\nconst validateTimeout = () => {\n  timeinFormInfo.value = timeoutFormInfo.value;\n};\n\nconst validateHousingType = () => {\n  const {min, message, placeholder} = housingValidationInfo[typeHousing.value];\n  priceHousing.placeholder = placeholder;\n  const priceHousingValue = parseInt(priceHousing.value, 10);\n\n  const errorMessage = priceHousingValue < min ? message : ``;\n\n  priceHousing.setCustomValidity(errorMessage);\n};\n\nconst addEventFrom = () => {\n  formInfo.addEventListener(`change`, (evt) => {\n    switch (evt.target.id) {\n      case roomNumber.id:\n        validateRooms();\n        break;\n      case capacity.id:\n        validateCapacity();\n        break;\n      case timeoutFormInfo.id:\n        validateTimeout();\n        break;\n      case timeinFormInfo.id:\n        validateTimein();\n        break;\n      case typeHousing.id:\n      case priceHousing.id:\n        validateHousingType();\n        initHousingValidationInfo();\n        break;\n    }\n\n    formInfo.reportValidity();\n  });\n};\n\nconst activate = () => {\n  formInfo.classList.remove(`ad-form--disabled`);\n  window.utils.changeDisabledElemetsForm(fieldsetFormInfo);\n  window.move.updateAddress();\n};\n\nconst resetInput = () => {\n  formInfo.reset();\n  window.move.updateAddress();\n  priceHousing.placeholder = MinPriceHousing.FLAT;\n};\n\nconst reset = () => {\n  formInfo.classList.add(`ad-form--disabled`);\n  window.utils.changeDisabledElemetsForm(fieldsetFormInfo);\n  window.move.updateAddress();\n};\n\nconst fullReset = () => {\n  window.map.fullReset();\n  window.card.closePopup();\n  window.photos.reset();\n  reset();\n  resetInput();\n};\n\nconst renderMessage = (messageType) => {\n  popupMessage = messageType.cloneNode(true);\n  document.body.append(popupMessage);\n};\n\nconst onLoadSuccess = () => {\n  fullReset();\n  renderMessage(successPopup);\n  addEventMessage();\n};\n\n\nconst onLoadError = () => {\n  renderMessage(errorPopup);\n  addEventMessage();\n};\n\nconst closePopupMessage = () => {\n  if (popupMessage !== null) {\n    popupMessage.remove();\n    popupMessage = null;\n    removeEventMessage();\n  }\n};\n\nconst onDocumentKeyDown = (evt) => {\n  if (evt.keyCode === ESC_KEY) {\n    evt.preventDefault();\n    closePopupMessage();\n  }\n};\n\nconst onDocumentClick = () => {\n  closePopupMessage();\n};\n\nconst addEventMessage = () => {\n  document.addEventListener(`keydown`, onDocumentKeyDown);\n  document.addEventListener(`click`, onDocumentClick);\n};\n\nconst removeEventMessage = () => {\n  document.removeEventListener(`keydown`, onDocumentKeyDown);\n  document.removeEventListener(`click`, onDocumentClick);\n};\n\nconst onFormSubmit = (evt) => {\n  window.backend.upload(new FormData(formInfo), onLoadSuccess, onLoadError);\n  evt.preventDefault();\n};\n\nresetForm.addEventListener(`click`, () => {\n  fullReset();\n});\n\nconst setAddress = ({valueX, valueY}) => {\n  address.value = `${valueX}, ${valueY}`;\n};\n\nformInfo.addEventListener(`submit`, onFormSubmit);\n\n\nconst init = () => {\n  initHousingValidationInfo();\n  reset();\n  addEventFrom();\n  addEventTitle();\n\n  validateRooms();\n  validateCapacity();\n  validateHousingType();\n};\n\nwindow.form = {\n  activate,\n  init,\n  setAddress\n};\n\n","\"use strict\";\n\nconst FILE_TYPES = [`gif`, `jpg`, `jpeg`, `png`];\nconst DEFAULT_PICTURES = `img/muffin-grey.svg`;\n\nconst fileChooserAvatar = document.querySelector(`.ad-form__field input[type=file]`);\nconst previewAvatar = document.querySelector(`.ad-form-header__preview img`);\n\nconst fileChooserHouse = document.querySelector(`.ad-form__upload input[type=file]`);\nconst previewHouse = document.querySelector(`.ad-form__photo`);\n\nconst imgHouse = document.createElement(`img`);\n\nconst loadAvatar = (result) => {\n  previewAvatar.src = result;\n};\n\nconst loadPreviewHouse = (result) => {\n  previewHouse.appendChild(imgHouse);\n  imgHouse.src = result;\n  imgHouse.style.width = previewHouse.offsetWidth + `px`;\n  imgHouse.style.height = previewHouse.offsetHeight + `px`;\n};\n\nconst reset = () => {\n  imgHouse.remove();\n  previewAvatar.src = DEFAULT_PICTURES;\n};\n\nconst onLoadChange = (evt, cb) => {\n  const file = evt.target.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener(`load`, () => {\n      cb(reader.result);\n    });\n    reader.readAsDataURL(file);\n  }\n};\n\nconst init = () => {\n  fileChooserAvatar.addEventListener(`change`, (evt) => {\n    onLoadChange(evt, loadAvatar);\n  });\n\n  fileChooserHouse.addEventListener(`change`, (evt) => {\n    onLoadChange(evt, loadPreviewHouse);\n  });\n};\n\nwindow.photos = {\n  init,\n  reset\n};\n\n","\"use strict\";\n\nconst pinsContainer = document.querySelector(`.map__pins`);\nconst block = document.querySelector(`.map`);\nconst mapFilters = document.querySelector(`.map__filters`);\nconst selectMapFilters = mapFilters.getElementsByTagName(`select`);\nconst fieldsetMapFilters = mapFilters.getElementsByTagName(`fieldset`);\n\nlet isPageActive = false;\n\nlet pinElements = [];\nlet items = [];\n\nconst renderPins = (pins) => {\n  const fragment = document.createDocumentFragment();\n\n  pins.forEach((pin) => {\n    const pinElement = window.pin.getElement(pin);\n    pinElements.push(pinElement);\n    fragment.appendChild(pinElement);\n  });\n\n  pinsContainer.appendChild(fragment);\n};\n\nconst resetPins = () => {\n  pinElements.forEach((pin) => {\n    pin.remove();\n  });\n\n  pinElements = [];\n};\n\nconst onLoadError = (errorMessage) => {\n  const node = document.createElement(`p`);\n  node.style = `z-index: 100; margin: 100px auto; text-align: center; border: 3px solid red; font-size: 30px; border-radius: 10px; width: auto; max-width: 600px; padding: 10px; background-color: white;`;\n  node.style.position = `absolute`;\n  node.style.left = 0;\n  node.style.right = 0;\n  node.style.fontSize = `30px`;\n\n  node.textContent = errorMessage;\n  document.body.insertAdjacentElement(`afterbegin`, node);\n};\n\nconst onLoadSuccess = (pins) => {\n  items = pins;\n  renderPins(window.filter.getResult(items));\n};\n\nconst render = () => {\n  window.backend.load(onLoadSuccess, onLoadError);\n};\n\nconst resetFilters = () => {\n  window.utils.changeDisabledElemetsForm(selectMapFilters);\n  window.utils.changeDisabledElemetsForm(fieldsetMapFilters);\n};\n\nconst activate = () => {\n  isPageActive = true;\n  block.classList.remove(`map--faded`);\n  window.form.activate();\n  resetFilters();\n  render();\n};\n\nconst resetPage = () => {\n  isPageActive = false;\n  block.classList.add(`map--faded`);\n};\n\nconst getIsPageActive = () => {\n  return isPageActive;\n};\n\nconst changeFilters = () => {\n  mapFilters.addEventListener(`change`, window.utils.debounce(() => {\n    resetPins();\n    window.card.closePopup();\n    renderPins(window.filter.getResult(items));\n  }));\n};\n\nconst fullReset = () => {\n  resetPins();\n  window.move.resetMainPin();\n  resetPage();\n  resetFilters();\n  mapFilters.reset();\n};\n\nconst init = () => {\n  fullReset();\n  changeFilters();\n};\n\nwindow.map = {\n  getIsPageActive,\n  init,\n  activate,\n  fullReset,\n  block\n};\n\n","\"use strict\";\n\nconst mapOverlay = document.querySelector(`.map__overlay`);\nconst pinMain = document.querySelector(`.map__pin--main`);\n\nconst SizeMainPin = {\n  WIDTH: 65,\n  HEIGHT: 65,\n  FULL_HEIGHT: 87\n};\n\nconst partSizeWidth = Math.floor(SizeMainPin.WIDTH / 2);\n\nconst LocationCheckpoint = {\n  X_MIN: 0,\n  Y_MIN: 130,\n  Y_MAX: 630\n};\n\nconst LocationLimit = {\n  X_MIN: LocationCheckpoint.X_MIN - partSizeWidth,\n  X_MAX: mapOverlay.offsetWidth - partSizeWidth,\n  Y_MIN: LocationCheckpoint.Y_MIN - SizeMainPin.FULL_HEIGHT,\n  Y_MAX: LocationCheckpoint.Y_MAX - SizeMainPin.FULL_HEIGHT\n};\n\nconst StartLocationMainPin = {\n  LEFT: 570,\n  TOP: 375\n};\n\nconst pin = () => {\n\n  pinMain.addEventListener(`mousedown`, (evt) => {\n    evt.preventDefault();\n\n    if (!window.map.getIsPageActive()) {\n      window.map.activate();\n    }\n\n    let startCoords = {\n      x: evt.clientX,\n      y: evt.clientY\n    };\n\n    const onMouseMove = (moveEvt) => {\n      moveEvt.preventDefault();\n\n      let shift = {\n        x: startCoords.x - moveEvt.clientX,\n        y: startCoords.y - moveEvt.clientY\n      };\n\n      startCoords = {\n        x: moveEvt.clientX,\n        y: moveEvt.clientY\n      };\n\n      const offsetLeft = pinMain.offsetLeft - shift.x;\n      const offsetTop = pinMain.offsetTop - shift.y;\n\n      getAddress(offsetLeft, offsetTop);\n\n      const isAddressValid = offsetTop >= LocationLimit.Y_MIN &&\n        offsetTop <= LocationLimit.Y_MAX &&\n        offsetLeft >= LocationLimit.X_MIN &&\n        offsetLeft <= LocationLimit.X_MAX;\n\n      const pinMove = () => {\n        if (isAddressValid) {\n          pinMain.style.left = (offsetLeft) + `px`;\n          pinMain.style.top = (offsetTop) + `px`;\n          window.form.setAddress(getAddress(offsetLeft, offsetTop));\n        }\n      };\n      pinMove();\n    };\n    const onMouseUp = (upEvt) => {\n      upEvt.preventDefault();\n\n      document.removeEventListener(`mousemove`, onMouseMove);\n      document.removeEventListener(`mouseup`, onMouseUp);\n\n      updateAddress();\n\n      const onClickPreventDefault = (clickEvt) => {\n        clickEvt.preventDefault();\n        pinMain.removeEventListener(`click`, onClickPreventDefault);\n      };\n      pinMain.addEventListener(`click`, onClickPreventDefault);\n    };\n\n    document.addEventListener(`mousemove`, onMouseMove);\n    document.addEventListener(`mouseup`, onMouseUp);\n  });\n};\n\nconst getAddress = (offsetLeft, offsetTop) => {\n  let valueX = offsetLeft + partSizeWidth;\n  let valueY = offsetTop + (!window.map.getIsPageActive() ? Math.floor(SizeMainPin.HEIGHT / 2) : SizeMainPin.FULL_HEIGHT);\n\n  return {\n    valueX, valueY\n  };\n};\n\nconst resetMainPin = () => {\n  pinMain.style.left = StartLocationMainPin.LEFT + `px`;\n  pinMain.style.top = StartLocationMainPin.TOP + `px`;\n};\n\nconst updateAddress = () => {\n  const {offsetLeft, offsetTop} = pinMain;\n  window.form.setAddress(getAddress(offsetLeft, offsetTop));\n};\n\nwindow.move = {\n  pin,\n  updateAddress,\n  resetMainPin\n};\n","\"use strict\";\n\nconst popupTemplate = document.querySelector(`#card`).content.querySelector(`.map__card`);\nconst ESC_KEY = 27;\n\nconst OfferType = {\n  FLAT: `flat`,\n  BUNGALOW: `bungalow`,\n  HOUSE: `house`,\n  PALACE: `palace`\n};\n\nconst offerTypesDictionary = {\n  [OfferType.FLAT]: `Квартира`,\n  [OfferType.BUNGALOW]: `Бунгало`,\n  [OfferType.HOUSE]: `Дом`,\n  [OfferType.PALACE]: `Дворец`,\n};\n\nlet popupElement = null;\n\nconst addPopupFeatures = (featuresElement, features) => {\n  if (!features.length) {\n    featuresElement.remove();\n    return;\n  }\n\n  const featureTemplate = featuresElement.querySelector(`.popup__feature`);\n  featuresElement.innerHTML = ``;\n\n  features.forEach((feature) => {\n    const featureElement = featureTemplate.cloneNode(true);\n    featureElement.className = `popup__feature popup__feature--${feature}`;\n    featuresElement.appendChild(featureElement);\n  });\n};\n\nconst addPopupPhotos = (photosElement, photos) => {\n  if (!photos.length) {\n    photosElement.remove();\n    return;\n  }\n\n  const photoTemplate = photosElement.querySelector(`.popup__photo`);\n  photosElement.innerHTML = ``;\n\n  photos.forEach((photo) => {\n    const photoElement = photoTemplate.cloneNode(true);\n    photoElement.src = `${photo}`;\n    photosElement.appendChild(photoElement);\n  });\n};\n\nconst closePopup = () => {\n  if (popupElement !== null) {\n    popupElement.remove();\n    popupElement = null;\n    window.pin.resetActiveElement();\n  }\n};\n\nconst renderPopup = (pin) => {\n  closePopup();\n\n  const {offer: {title, address, price, type, rooms, guests, checkin, checkout, features, description, photos}, author: {avatar}} = pin;\n\n  popupElement = popupTemplate.cloneNode(true);\n\n  popupElement.querySelector(`.popup__title`).textContent = title;\n  popupElement.querySelector(`.popup__text--address`).textContent = address;\n  popupElement.querySelector(`.popup__text--price`).textContent = `${price}₽/ночь`;\n\n  popupElement.querySelector(`.popup__type`).textContent = offerTypesDictionary[type];\n  popupElement.querySelector(`.popup__text--capacity`).textContent = `${rooms} комнаты для ${guests} гостей`;\n  popupElement.querySelector(`.popup__text--time`).textContent = `Заезд после ${checkin}, выезд до ${checkout}`;\n\n  popupElement.querySelector(`.popup__avatar`).src = avatar;\n\n  addPopupFeatures(popupElement.querySelector(`.popup__features`), features);\n  popupElement.querySelector(`.popup__description`).textContent = description;\n\n  addPopupPhotos(popupElement.querySelector(`.popup__photos`), photos);\n\n  window.map.block.appendChild(popupElement);\n\n  const popupCloseButton = popupElement.querySelector(`.popup__close`);\n\n  popupCloseButton.addEventListener(`click`, () => {\n    closePopup();\n  });\n\n  window.map.block.addEventListener(`keydown`, (evt) => {\n    if (evt.keyCode === ESC_KEY) {\n      evt.preventDefault();\n      closePopup();\n    }\n  });\n};\n\nwindow.card = {\n  renderPopup,\n  closePopup,\n  OfferType\n};\n","\"use strict\";\n\nwindow.map.init();\nwindow.move.pin();\nwindow.form.init();\nwindow.photos.init();\n\n"],"sourceRoot":""}